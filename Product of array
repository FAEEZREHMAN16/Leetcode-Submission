#include <stdlib.h>

// Caller must free returned array. returnSize set to numsSize.
int* productExceptSelf(int* nums, int numsSize, int* returnSize){
    *returnSize = numsSize;
    int *out = malloc(numsSize * sizeof(int));
    if(!out) return NULL;
    // left products
    int left = 1;
    for(int i=0;i<numsSize;i++){
        out[i] = left;
        left *= nums[i];
    }
    // multiply by right products
    int right = 1;
    for(int i=numsSize-1;i>=0;i--){
        out[i] *= right;
        right *= nums[i];
    }
    return out;
}
